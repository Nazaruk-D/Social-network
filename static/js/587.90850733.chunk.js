"use strict";(self.webpackChunksamurai_way=self.webpackChunksamurai_way||[]).push([[587],{6587:function(e,s,a){a.r(s),a.d(s,{default:function(){return B}});var n=a(8687),i=a(9403),r=a(7781),t=a(2982),d=a(885),c=a(2791),l="Dialogs_dialogsContainer__utsXu",u="Dialogs_friendsList__-PNM8",o="Dialogs_title__NhgXm",m="Dialogs_messages__UmrN6",g=a(9271),_="Message_messageContainer__RgjE-",v="Message_myMessageBlock__F329T",f="Message_myMessage__4rjng",j="Message_data__vD1dv",h="Message_delete__pOkaF",x="Message_friendsMessageBlock__NaEXT",N="Message_friendsMessage__if86N",M=a(6856),k=a(184),S=function(e){var s=(0,g.UO)().userId;return(0,k.jsx)("div",{className:_,children:"all"!==s?e.messages.map((function(a){return a.myPost?(0,k.jsxs)("div",{className:v,children:[(0,k.jsxs)("div",{className:f,children:[(0,k.jsx)("div",{children:a.message}),(0,k.jsx)("div",{className:j,children:a.dataMessage})]}),(0,k.jsx)("div",{className:h,onClick:function(){return n=s,i=a.idMessage,void e.deleteMessage(n,i);var n,i},children:(0,k.jsx)(M.FH3,{style:{fontSize:"20px"}})})]},a.idMessage):(0,k.jsx)("div",{className:x,children:(0,k.jsxs)("div",{className:N,children:[(0,k.jsx)("div",{children:a.message}),(0,k.jsx)("div",{className:j,children:a.dataMessage})]})},a.idMessage)})).reverse():e.messages.map((function(e){return e.myPost?(0,k.jsx)("div",{className:v,children:(0,k.jsxs)("div",{className:f,children:[(0,k.jsx)("div",{children:e.message}),(0,k.jsx)("div",{className:j,children:e.userName})]})},e.idMessage):(0,k.jsx)("div",{className:x,children:(0,k.jsxs)("div",{className:N,children:[(0,k.jsx)("div",{children:e.message}),(0,k.jsx)("div",{className:j,children:e.userName})]})},e.idMessage)})).reverse()})},p="FriendsList_friendBlock__VubZB",D="FriendsList_friend__H1RoS",F="FriendsList_ava__qeGjP",y="FriendsList_nameTd__POguG",C=a(1523),b=function(e){var s=e.name,a=e.ava,n=e.id;return(0,k.jsx)("div",{className:p,children:(0,k.jsxs)(C.OL,{to:"/dialogs/"+n,className:D,children:[(0,k.jsx)("img",{src:a,className:F,alt:"avatar"}),(0,k.jsx)("div",{className:y,children:s})]})})},w=a(1957),Z=a(0),A=a(4061),P=a(2932),B=(0,r.qC)(P.D,(0,n.$j)((function(e){return{dialogs:e.dialogs}}),(function(e){return{SendMessage:function(s,a){e((0,i.XE)(s,a))},DeleteMessage:function(s,a){e((0,i.$Z)(s,a))}}})))((function(e){var s=(0,g.UO)().userId,a=function(s,a){e.DeleteMessage(s,a)},n=e.dialogs.map((function(e){return(0,k.jsx)("div",{children:(0,k.jsx)(b,{name:e.name,id:e.id,ava:e.ava})},e.id)})),r=e.dialogs.map((function(e,n){return e.id===s?(0,k.jsx)("div",{children:(0,k.jsx)(S,{messages:e.messages,deleteMessage:a})},n):null})),_=(0,Z.TL)(),v=(0,c.useState)(null),f=(0,d.Z)(v,2),j=f[0],h=f[1],x=(0,c.useState)([]),N=(0,d.Z)(x,2),M=N[0],p=N[1];j&&(j.onmessage=function(e){var s=JSON.parse(e.data);p([].concat((0,t.Z)(M),(0,t.Z)(s)))}),(0,c.useEffect)((function(){var e=new WebSocket("wss://social-network.samuraijs.com/handlers/ChatHandler.ashx");h(e)}),[]),(0,c.useEffect)((function(){var e=M.map((function(e,s){return{idMessage:s,userName:e.userName,message:e.message,dataMessage:(0,A.p)(new Date),myPost:25415===e.userId}}));_((0,i.Gg)(e))}),[M,_]);return(0,k.jsxs)("div",{className:l,children:[(0,k.jsxs)("div",{className:u,children:[(0,k.jsx)("div",{className:o,children:"Friends list"}),n]}),(0,k.jsxs)("div",{className:m,children:[r,"all"===s?(0,k.jsx)(w.S,{onSubmit:function(e){j.send(e)}}):(0,k.jsx)(w.S,{onSubmit:function(a){e.SendMessage(a,s)}})]})]})}))},1957:function(e,s,a){a.d(s,{S:function(){return u}});var n=a(885),i=a(2791),r="AddMessageForm_addMessageFormBlock__6flMP",t="AddMessageForm_textField__D9IqF",d="BigButton_button__G3XYN",c=a(184),l=function(e){var s=e.onClick;return(0,c.jsx)("button",{className:d,onClick:s,children:"AddPost"})},u=function(e){var s=(0,i.useState)(""),a=(0,n.Z)(s,2),d=a[0],u=a[1];return(0,c.jsxs)("div",{className:r,children:[(0,c.jsx)("textarea",{className:t,placeholder:"Enter your message",value:d,onChange:function(e){u(e.currentTarget.value)},onKeyDown:function(s){"Enter"===s.key&&(e.onSubmit(d),u(""))}}),(0,c.jsx)(l,{onClick:function(){""!==d&&(e.onSubmit(d),u(""))}})]})}},2932:function(e,s,a){a.d(s,{D:function(){return o}});var n=a(8683),i=a(5987),r=(a(2791),a(9271)),t=a(8687),d=a(6895),c=a(184),l=["isAuth"],u=function(e){return{isAuth:e.auth.isAuth}};function o(e){return(0,t.$j)(u,{getAuthUserData:d.RK,logout:d.kS})((function(s){var a=s.isAuth,t=(0,i.Z)(s,l);return a?(0,c.jsx)(e,(0,n.Z)({},t)):(0,c.jsx)(r.l_,{to:"/login"})}))}}}]);
//# sourceMappingURL=587.90850733.chunk.js.map